<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tropical System Stats</title>
    <link href="{{ url_for('static', filename='style.css') }}" rel="stylesheet" />
    <script lang="JavaScript">
        function showForm(dowhat) {
            if (dowhat == 'update') {
                document.getElementById('browse').style.display = 'none';
                document.getElementById('insert').style.display = 'none';
                document.getElementById('update').style.display = 'block';
                document.getElementById('delete').style.display = 'none';
            }
            else if (dowhat == 'insert') {
                document.getElementById('browse').style.display = 'none';
                document.getElementById('insert').style.display = 'block';
                document.getElementById('update').style.display = 'none';
                document.getElementById('delete').style.display = 'none';
            }
            else if (dowhat == 'delete') {
                document.getElementById('browse').style.display = 'none';
                document.getElementById('insert').style.display = 'none';
                document.getElementById('update').style.display = 'none';
                document.getElementById('delete').style.display = 'block';
            }
            else {
                document.getElementById('browse').style.display = 'block';
                document.getElementById('insert').style.display = 'none';
                document.getElementById('update').style.display = 'none';
                document.getElementById('delete').style.display = 'none';
            }
        }

        function addStats(season_id) { 
            document.getElementById('season_display').innerHTML = `Season: <strong>${season_id}</strong>`;
            showForm('insert'); }
        function updateStats(stat_id, season_id, system_id, min_pressure, max_wind_speed, max_rainfall, max_storm_surge, death_count, injury_count, total_cost) {
            document.getElementById('season_display1').innerHTML = `Season: <strong>${season_id}</strong>`;
            document.getElementById('system_display').innerHTML = `System ID: <strong>${system_id}</strong>`;
            document.getElementById('update_stat_id').value = stat_id;
            document.getElementById('update_season_id').value = season_id;
            document.getElementById('update_system_id').value = system_id;
            document.getElementById('update_min_pressure').value = min_pressure;
            document.getElementById('update_max_wind_speed').value = max_wind_speed;
            document.getElementById('update_max_rainfall').value = max_rainfall;
            document.getElementById('update_max_storm_surge').value = max_storm_surge;
            document.getElementById('update_death_count').value = death_count;
            document.getElementById('update_injury_count').value = injury_count;
            document.getElementById('update_total_cost').value = total_cost;
            showForm('update');
        }
        function deleteStat(stat_id, season_id, system_id) {
        document.getElementById('delete_stat_id').value = stat_id;
        document.getElementById('season_display2').innerHTML = `Season: <strong>${season_id}</strong>`;
        document.getElementById('system_display2').innerHTML = `System ID: <strong>${system_id}</strong>`;
        showForm('delete');
        }
        function browseStats() { showForm ('browse');}
    </script>
</head>
<body onload="showForm('browse')">
    <h1>Tropical System Stats</h1>
    <nav>
        <a href="{{ url_for('index') }}">Home</a> |
        <a href="{{ url_for('tropical_systems') }}">Tropical Systems</a> |
        <a href="{{ url_for('impacts') }}">Impacts</a> |
        <a href="{{ url_for('tropical_system_impacts') }}">Tropical System Impacts</a> |
        <a href="{{ url_for('tropical_system_stats') }}">Tropical System Stats</a>
    </nav>

    <h3>View tropical system stats for a given season</h3>
    <h5>Steps to make Add, Edit, and Delete functions work:
        <ol>
            <li>Select season from dropdown menu for "Season" and then press "Browse Stats"</li>
            <li>Make any changes needed</li>
        </ol>
        This is required in order to fill in the dropdown menus. 
    </h5>
    <div id="browse">
        <form method="post" action="{{ url_for('tropical_system_stats') }}">
            <fieldset>
                <label>Season:</label>
                <select name="seasonSelect">
                    <option>-- Select Season --</option>
                    {% for HurricaneSeasons in HurricaneSeasons %}
                    <option value="{{ HurricaneSeasons.season_id }}">{{ HurricaneSeasons.season_id }}</option>
                    {% endfor %}
                </select>
                <input type="submit" value="Browse Stats">
            </fieldset>
        </form>
        <table border="1" cellpadding="5">
            <tr>
                <th><button type="button" onclick="addStats(
                    '{{ season_id }}'
                )">New</button></th>
                <th></th>
                <th>Stat ID</th>
                <th>Season ID</th>
                <th>System ID</th>
                <th>Min Pressure</th>
                <th>Max Wind Speed</th>
                <th>Max Rainfall</th>
                <th>Max Storm Surge</th>
                <th>Death Count</th>
                <th>Injury Count</th>
                <th>Total Cost</th>
            </tr>
            {% for TropicalSystemStats in TropicalSystemStats %}
            <tr>
                <td><button type="button" onclick="deleteStat(
                    '{{ TropicalSystemStats.stat_id }}',
                    '{{ TropicalSystemStats.season_id}}',
                    '{{ TropicalSystemStats.system_id }}'
                    )">Delete</button></td>
                <td><button type="button" onclick="updateStats(
                    '{{ TropicalSystemStats.stat_id }}', 
                    '{{ TropicalSystemStats.season_id }}', 
                    '{{ TropicalSystemStats.system_id }}', 
                    '{{ TropicalSystemStats.min_pressure }}', 
                    '{{ TropicalSystemStats.max_wind_speed }}', 
                    '{{ TropicalSystemStats.max_rainfall }}', 
                    '{{ TropicalSystemStats.max_storm_surge }}', 
                    '{{ TropicalSystemStats.death_count }}', 
                    '{{ TropicalSystemStats.injury_count }}', 
                    '{{ TropicalSystemStats.total_cost }}'
                    )">Edit</button></td>
                <td>{{ TropicalSystemStats.stat_id }}</td>
                <td>{{ TropicalSystemStats.season_id }}</td>
                <td>{{ TropicalSystemStats.system_id }}</td>
                <td>{{ TropicalSystemStats.min_pressure }}</td>
                <td>{{ TropicalSystemStats.max_wind_speed }}</td>
                <td>{{ TropicalSystemStats.max_rainfall }}</td>
                <td>{{ TropicalSystemStats.max_storm_surge }}</td>
                <td>{{ TropicalSystemStats.death_count }}</td>
                <td>{{ TropicalSystemStats.injury_count }}</td>
                <td>{{ TropicalSystemStats.total_cost }}</td>
            </tr>
            {% endfor %}
        </table>
        
    </div>

    <!-- Insert Stat -->
    <div id="insert" style="display: none;">
        <form method="post" action="{{ url_for('add_tropical_system_stat') }}">
            <legend><strong>Add storm stats</strong></legend>
            <fieldset>
                <p id="season_display" class="season_display"></p>
                <input type="hidden" name="season_id" value="{{ season_id }}">
                <label>System ID:</label>
                    <select name="system_id" id="season_id">
                        <option>-- Select System --</option>
                        {% for TropicalSystems in TropicalSystems %}
                        <option value="{{ TropicalSystems.system_id}}">
                            {{ TropicalSystems.system_id }} - {{ TropicalSystems.name }}</option>
                        {% endfor %}
                    </select>
                <label>Min Pressure:</label> <input type="text" name="min_pressure">
                <label>Max Wind Speed:</label> <input type="text" name="max_wind_speed">
                <label>Max Rainfall:</label> <input type="text" name="max_rainfall">
                <label>Max Storm Surge:</label> <input type="text" name="max_storm_surge">
                <label>Death Count:</label> <input type="text" name="death_count">
                <label>Injury Count:</label> <input type="text" name="injury_count">
                <label>Total Cost:</label> <input type="text" name="total_cost">
            </fieldset>
            <input type="submit" value="Add Stat">
            <input type="button" value="Cancel" onclick="showForm('browse')">
        </form>
    </div>

    <!-- Update Stat -->
    <div id="update" style="display: none;">
        <form method="post" action="{{ url_for('update_tropical_system_stat') }}">
            <legend><strong>Edit Existing System Stats</strong></legend>
            <fieldset>
                <input type="hidden" name="stat_id" id="update_stat_id">
                <p id="season_display1" class="season_display1"></p>
                <p id="system_display" class="system_display"></p>
                <input type="hidden" name="season_id" id="update_season_id">
                <input type="hidden" name="system_id" id="update_system_id">
                <label>Min Pressure:</label> <input type="text" name="min_pressure" id="update_min_pressure">
                <label>Max Wind Speed:</label> <input type="text" name="max_wind_speed" id="update_max_wind_speed">
                <label>Max Rainfall:</label> <input type="text" name="max_rainfall" id="update_max_rainfall">
                <label>Max Storm Surge:</label> <input type="text" name="max_storm_surge" id="update_max_storm_surge">
                <label>Death Count:</label> <input type="text" name="death_count" id="update_death_count">
                <label>Injury Count:</label> <input type="text" name="injury_count" id="update_injury_count">
                <label>Total Cost:</label> <input type="text" name="total_cost" id="update_total_cost">
            </fieldset>
            <input type="submit" value="Update Stat">
            <input type="button" value="Cancel" onclick="showForm('browse')">
        </form>
    </div>

    <!-- Delete Stat -->
    <div id="delete" style="display: none;">
        <form method="post" action="{{ url_for('delete_tropical_system_stat') }}">
            <legend><strong>Delete Stats for a Storm</strong></legend>
            <fieldset>
                <p>Are you sure you want to delete the stats for this storm?</p>
                <p id="season_display2" class="season_display2"></p>
                <p id="system_display2" class="system_display2"></p>
                <input type="hidden" name="stat_id" id="delete_stat_id">

            </fieldset>
            <input type="submit" value="Delete Stat">
            <input type="button" value="Cancel" onclick="browseStats()">
        </form>
    </div>
</body>
</html>
